!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).UserIntent={})}(this,(function(t){"use strict";function e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function n(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){i(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function c(){var t=this;this.invoked||(clearTimeout(this.timer),this.timer=setTimeout((function(){t.fire()}),this._opts.delay))}function l(){for(var t=this._opts.events,e=t.length,n=0;n<e;n+=1){var o=t[n],i=c.bind(this);this.attachEvents([{el:document,type:o,listener:i}])}}var f=0,a=0;function d(t,e){var n=window.pageYOffset||document.documentElement.scrollTop,o=n>f,i=t*(parseFloat(this._opts.percentDown)/100),r=e?a-Math.round(a/100*e):0;o&&!e&&n>=i&&this.fire(),!o&&r&&n<=r&&a>=i&&this.fire(),o&&e&&(a=n),f=n<=0?0:n}function u(){this.windowBlurred=!0}function p(){this.windowBlurred&&!this.invoked&&(this.fire(),this.windowBlurred=!1)}function h(t){!this.invoked&&t.clientY<0&&this.fire()}var v={idle:{fn:function(){var t=c.bind(this);this.attachEvents([{el:window,type:"load",listener:t}]),l.call(this)},opts:{events:["mousedown","mousemove","keypress","scroll","touchstart"],delay:1e4,multiple:!1}},scroll:{fn:function(){var t=document.body,e=document.documentElement,n=Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.scrollHeight,e.offsetHeight);n=parseInt(n-window.innerHeight,10),this._opts.offsetTop&&(n-=this._opts.offsetTop),this._opts.offsetBottom&&(n+=this._opts.offsetBottom);var o=d.bind(this,n,this._opts.percentUp);this.invoked||this.attachEvents([{el:window,type:"scroll",listener:o}])},opts:{percentDown:50,percentUp:0,offsetTop:0,offsetBottom:0}},target:{fn:function(){var t=this;if(this._opts.target){var e=document.querySelector(this._opts.target);if(e){var n={rootMargin:"".concat(this._opts.offsetTop,"px 0px ").concat(this._opts.offsetBottom,"px 0px")},o=new IntersectionObserver((function(e){e.forEach((function(e){e.isIntersecting&&!t.invoked&&(t.fire(),t._opts.multiple||o.unobserve(e.target))}))}),n);o.observe(e)}else console.error('ðŸ”¥ cannot find the provided target "'.concat(this._opts.target,'".'))}else console.error("ðŸ”¥ you have to provide a target selector within the options object to UserIntent().")},opts:{target:"",offsetTop:0,offsetBottom:0,multiple:!1}},focus:{fn:function(){var t=u.bind(this),e=p.bind(this),n="",o="",i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if("hidden"in document&&(n="hidden",o="visibilitychange"),"mozHidden"in document&&(n="mozHidden",o="mozvisibilitychange"),"webkitHidden"in document&&(n="webkitHidden",o="webkitvisibilitychange"),"msHidden"in document&&(n="msHidden",o="msvisibilitychange"),n&&o&&!i){this.attachEvents([{el:document,type:o,listener:function(){(document[n]?t:e)()}}])}else this.attachEvents([{el:window,type:"blur",listener:t},{el:window,type:"focus",listener:e}])},opts:{multiple:!1}},out:{fn:function(){var t=h.bind(this);this.attachEvents([{el:document,type:"mouseleave",listener:t}])},opts:{multiple:!1}}},m=Object.freeze(v);function y(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=t.length;if(e)for(var n=0;n<e;n+=1){var o=t[n];o.el.removeEventListener(o.type,o.listener)}}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=t.length;if(e)for(var n=0;n<e;n+=1){var o=t[n],i=o.el,r=o.type,s=o.listener;i.addEventListener(r,s)}}t.default=function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"===o(i))if(void 0!==t)if(i.mode&&void 0===m[i.mode])console.error("ðŸ”¥ wrong mode passed to UserIntent().");else{var s=i.mode||"out",c=n({},i);delete c.mode;var l=m[s].opts,f=Object.keys(l),a=f.length;if(a)for(var d=0;d<a;d+=1){var u=f[d],p=l[u];void 0===c[u]&&(c[u]=p)}this._mode=s,this._opts=c,this._cb=t,this.invoked=!1,this.timer=null,this.windowBlurred=!1,this.addedEvents=[],this.attachEvents=function(t){var n;b(t),(n=e.addedEvents).push.apply(n,r(t))},this.fire=function(){t(e._mode,n({},e._opts)),e._opts.multiple||(e.invoked=!0,y(e.addedEvents))},m[s].fn.call(this)}else console.error("ðŸ”¥ you have to pass a callback to UserIntent().");else console.error("ðŸ”¥ wrong options type passed to UserIntent().")}})),window.UserIntent=window.UserIntent.default;
//# sourceMappingURL=user-intent.min.js.map
